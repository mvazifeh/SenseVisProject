'''
Created on Mar 26, 2015

@author: Hongmou
'''
import arcpy

arcpy.env.overwriteOutput = True

# Local variables:
path = 'C:/Projects/MassHackathon/stopsForRoutes/routeSplit/'
path2 = 'C:/Projects/MassHackathon/stopsForRoutes/'

routeList = ['5000','5001','7101','7200','7301','7400','7700','7100','9000','9001','9101','9301','10000','10001','10500','10600','10900','10901','11200','11300','16300','16301','16900','16901','18000','18001','21000','21001','14200','9100','8100','8900','16201','16800','16801','4000','4001','4100','4101','27000','27001','30200','30201','24401','34100','34101','34200','34400','34500','34501','34300','34700','34701','34800','34801','24100','24201','24001','34900','34901','34950','35001','35000','36000','36001','36501','36801','36300','36500','36800','37000','37001','37300','37301','40000','40200','40501','42100','44101','44301','50000','50001','51000','51001','55001','43001','55100','55101','59000','59001','59200','59201','60000','60001','60201','60301','60400','62301','62300','62400','62800','62801','62401','64001','64601','65001','68000','68001','69001','70000','70100','70001','70101','70200','70301','70300','70401','70500','70800','70801','76300','65000','69000','76000','76400','76401','76301','76001','79000','83101','84100','84101','84200','84201','85000','85001','87001','87201','88001','88301','89001','89200','89201','94100','95000','95001','95200','95201','100000','100001','100100','100101','101001','101101','93001','93701','91000','91001','91700','91701','92701','89000','90001','101000','101100','97500','97501','99101','99700','99701','117901','101301','101401','104000','105100','105101','106000','108600','108700','109001','109100','109101','110001','110200','110400','110401','112000','112001','112100','112101','112300','108100','80000','80001','109000','101300','101400','111201','111501','111601','111801','131000','131200','131400','131401','134700','134701','134911','136300','136301','136400','131001','131100','132000','132001','134101','134200','134201','134300','134301','134500','134501','134600','134601','134900','134901','134910','137300','201000','201001','201700','201800','201801','201900','201901','202400','202500','202501','202600','202601','202301','202700','202701','210000','201701','111200','210001','210300','210301','212200','212201','215100','238700','211701','214100','214101','214200','214201','215300','215000','215001','215101','216200','216201','216000','216001','220301','220401','220501','221000','221001','222000','222001','222100','222101','222900','222901','225101','240300','210100','230501','230500','236200','236201','236300','236301','238000','238001','238300','238500','238701','238800','238801','238901','238900','240000','240100','240700','240800','220300','220500','220900','325100','274000','274001','275100','275800','411100','240400','245000','245100','553101','554000','554001','554200','554201','556000','556001','558000','558001','70501','94101','106400','136500','202401','211700','230300','230301','240900','245001','245101','245200','276501','276601','325001','325101','325200','325000','326000','326100','326101','326200','350401','350500','350501','350700','354000','354001','354300','354301','354400','354500','354501','426700','426701','429000','429100','429101','429200','225201','225401','240001','240101','240201','240301','240701','240901','429201','430600','350300','350400','708001','426400','424601','708200','276000','351300','351301','352000','352001','426000','426001','426100','426101','426500','428000','428001','431000','431001','430200','430100','450701','435001','435100','435000','435101','435300','435301','435400','435401','435201','435500','436200','439001','439000','439300','439301','441600','441601','441700','441900','441901','442100','441701','442101','442601','442600','442700','442701','442900','442901','448001','448100','448200','449100','449200','708201','742000','742101','742300','746000','746001','741000','741001','749000','751000','439200','751001','450901','749001','553701','558700','34961','34960','35100','35101','40500','450700','450900','451000','451001','451100','451101','455501','455600','455601','455701','455801','455900','456000','456001','456900','459000','465000','465001','465101','556700','556701','558701','55000','60200','170301','436201','455700','455800','465100','747000','747001','459001','434000','434001','450800','450801','106500','106501','106600','106700','106701','111500','111800','117200','171000','225100','505000','505001','505100','505101','553000','553001','553100','326001','429001','426900','449001','220400','11401','11201','11301','34000','40001','40201','34001','72000','72001','72500','72501','74000','74001','75000','75001','106001','106301','106401','108101','108601','108701','131201','131301','136401','136501','137301','275301','275801','411101','430101','430201','430601','225001','87000','87200','88000','89400','275101','1001','8101','8901','14000','14001','14100','14101','15000','15100','15200','110201','424000','15101','15001','15201','15401','16200','17000','17001','19301','19000','19001','22001','23000','23001','23201','78100','78200','78201','26100','26101','26200','26201','28000','28001','28201','29001','277001','29500','29501','29100','29101','31000','31001','32100','32000','32101','32001','33400','33501','33601','33701','38000','38001','39300','39301','41000','41001','41100','42101','43000','44100','44300','45100','45000','45001','45300','45301','47301','47800','47300','52000','52100','52400','52500','52001','52401','52501','52101','52600','52700','52701','57000','57001','57100','57101','64000','64300','64600','66600','66601','67401','70400','77000','77001','77400','77401','96000','96001','79001','78101','83100','86000','86001','86701','104001','110000','116900','119200','119100','170000','192000','192001','193000','193001','411800','411801','501001','501000','501100','501101','501301','503000','503001','502000','502001','504000','504001','504200','504201','701000','701001','701101','47801','708000','708100','114100','116400','116700','117500','120000','120001','121001','121201','1000','19300','22000','24200','24000','29000','33500','33600','71000','71001','71100','71101','71200','71201','73101','73200','90000','92700','708101','67400','93000','93700','116401','116701','117001','117100','117501','119101','119201','121000','121200','225000','225200','225300','225301','225400','225500','225501','503100','503101','608001','34600','191000','191001','34601','34931','73000','73001','73100','73201','92101','92100','92300','92301','93100','93101','93200','93201','100300','100301','114101','194000','194001','211000','211001','215301','217100','217301','217800','217900','217901','436000','436001','436100','436101','742001','742100','742301']

for shp in routeList:
    
    splitShape = path + 'split' + shp + '.shp'
    pointShape = path2 + 'routePt' + shp +'.shp'
    startPtShape = path + 'inter/' + shp + '_1.shp'
    startPtJoin = path + 'inter/' + shp + '_2.shp'
    endPtShape = path + 'inter/' + shp + '_3.shp'
    endPtJoin = path + 'inter/' + shp + '_4.shp'
    splitLayer = 'split' + shp + 'Layer'
    splitLayer2 = 'split' + shp + 'Layer'
    outputFile = path2 + 'splitRoute.gdb/splitJoin' + shp
    
    # Process: Make Feature Layer
    arcpy.MakeFeatureLayer_management(splitShape, splitLayer)
    
    # Process: Feature Vertices To Points
    arcpy.FeatureVerticesToPoints_management(splitShape, startPtShape, 'START')
    
    # Process: Spatial Join
    arcpy.SpatialJoin_analysis(startPtShape, pointShape, startPtJoin, 'JOIN_ONE_TO_ONE', 'KEEP_ALL', '#', 'CLOSEST', '', 'dist')
    
    # Process: Add Join
    arcpy.AddJoin_management(splitLayer, 'FID', startPtJoin, 'FID', 'KEEP_ALL')
    
    # Process: Feature Vertices To Points (2)
    arcpy.FeatureVerticesToPoints_management(splitShape, endPtShape, 'END')
    
    # Process: Spatial Join (2)
    arcpy.SpatialJoin_analysis(endPtShape, pointShape, endPtJoin, 'JOIN_ONE_TO_ONE', 'KEEP_ALL', '#', 'CLOSEST', '', 'dist')
    
    # Process: Add Join (2)
    arcpy.AddJoin_management(splitLayer, 'FID', endPtJoin, 'FID', 'KEEP_ALL')
    
    arcpy.CopyFeatures_management(splitLayer, outputFile)